@prefix : <http://schema.ufokn.org/core/v2/> .
@prefix ufokn: <http://schema.ufokn.org/core/v2/> .
@prefix ufokn-geo: <http://schema.ufokn.org/geo/v2/> .

@prefix geo: <http://www.opengis.net/ont/geosparql#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sosa: <http://www.w3.org/ns/sosa/> .
@prefix time: <http://www.w3.org/2006/time#> .
@prefix dcterms: <http://purl.org/dc/terms/> .

@base <http://schema.ufokn.org/core/v2/> .

<http://schema.ufokn.org/core/v2/> rdf:type owl:Ontology ;
                                    owl:versionIRI <http://schema.ufokn.org/core/v2/> ;
                                    owl:imports ufokn-geo: ;
                                    dcterms:created "2021-12-15"@en-us ;
                                    dcterms:creator <http://orcid.org/0000-0002-5331-5052> ,
                                    <http://orcid.org/0000-0003-4486-9448> ;
                                    dcterms:description "Part of the UFOKN ontology for describing infrastructure at risk due to flooding events."@en-us ;
                                    dcterms:issued "2021-12-15"^^xsd:date ;
                                    dcterms:modified "2021-12-15"^^xsd:date ;
                                    dcterms:publisher <http://ufokn.org> ;
                                    dcterms:source "https://github.com/UFOKN/Knowledge-Graph/ontologies/v2/core.owl"^^<xsd:anyURI> ;
                                    dcterms:title "Core of the UFOKN Ontology"@en-us ;
                                    rdfs:label "Risk points and events of the UFOKN Ontology"@en-us ;
                                    owl:versionInfo "2"@en-us .


#################################################################
#    Annotation properties
#################################################################

###  http://purl.org/dc/terms/created
dcterms:created rdf:type owl:AnnotationProperty .


###  http://purl.org/dc/terms/creator
dcterms:creator rdf:type owl:AnnotationProperty .


###  http://purl.org/dc/terms/description
dcterms:description rdf:type owl:AnnotationProperty .


###  http://purl.org/dc/terms/issued
dcterms:issued rdf:type owl:AnnotationProperty .


###  http://purl.org/dc/terms/modified
dcterms:modified rdf:type owl:AnnotationProperty .


###  http://purl.org/dc/terms/publisher
dcterms:publisher rdf:type owl:AnnotationProperty .


###  http://purl.org/dc/terms/source
dcterms:source rdf:type owl:AnnotationProperty .


###  http://purl.org/dc/terms/title
dcterms:title rdf:type owl:AnnotationProperty .


#################################################################
#    Datatypes
#################################################################

###  http://schema.ufokn.org/core/v1/depth
ufokn:depth rdf:type rdfs:Datatype .


###  http://schema.ufokn.org/core/v1/elevation
ufokn:elevation rdf:type rdfs:Datatype .


#################################################################
#    Object Properties
#################################################################

###  http://schema.ufokn.org/core/v2/fromDataSource
ufokn:fromDataSource rdf:type owl:ObjectProperty ;
                           rdfs:domain owl:Thing ;
                           rdfs:range ufokn:DataSource ;
                           rdfs:comment "A representation of a data source that contains things like model outputs, spatial features, risk points, or similar."@en ;
                           rdfs:label "fromDataSource"@en .


###  http://schema.ufokn.org/core/v2/comid
ufokn:comid rdf:type owl:ObjectProperty .

### from ufokn-geo; already declared there
###  http://www.opengis.net/ont/geosparql#hasGeometry
geo:hasGeometry rdf:type owl:ObjectProperty .

###  http://schema.ufokn.org/core/v2/hasRiskPoint
ufokn:hasRiskPoint rdf:type owl:ObjectProperty ;
                                   rdfs:domain ufokn:FeatureAtRisk ;
                                   rdfs:range ufokn:RiskPoint .
#                                   rdfs:comment "Relationship that assigns a FeatureAtRisk a RiskPoint as its point abstraction (that has spatial coordinates)."@en ;
#                                   rdfs:label "hasRiskPoint"@en .


###  http://schema.ufokn.org/core/v2/hasRelativeRiskPointLocation
ufokn:hasRelativeRiskPointLocation rdf:type owl:ObjectProperty ;
                                   owl:inverseOf ufokn:locationForRiskPoint ;
                                   rdfs:domain ufokn:RiskPoint ;
                                   rdfs:range ufokn:RelativeRiskPointLocation ;
                                   rdfs:comment "Relationship between a RiskPoint and its Localication Relative to the Spatial Model used by a Specific Modeling or Observation System. The relative location allows associating different elevations with a RiskPoint based on different spatial interpolation methods."@en ;
                                   rdfs:label "hasRelativeRiskPointLocation"@en .




###  http://schema.ufokn.org/core/v2/locationForRiskPoint
ufokn:locationForRiskPoint rdf:type owl:ObjectProperty .


###  http://www.w3.org/ns/sosa/hasFeatureOfInterest
sosa:hasFeatureOfInterest rdf:type owl:ObjectProperty .


###  http://schema.ufokn.org/ufokn-features/v2/hasAddress
ufokn:hasAddress rdf:type owl:ObjectProperty ;
			rdfs:domain ufokn:FeatureAtRisk ; 
			rdfs:range ufokn:Address .


###  http://schema.ufokn.org/ufokn-features/v2/hasUnitAddress
# only individual FeaturesAtRisk but not Collections can have unit addresses 
ufokn:hasUnitAddress rdf:type owl:ObjectProperty ;
			rdfs:subPropertyOf ufokn:hasAddress ;
			rdfs:domain ufokn:IndividualFeatureAtRisk ; 
			rdfs:range ufokn:UnitAddress .


###  http://schema.ufokn.org/ufokn-features/v2/hasStreetAddress
# any FeatureAtRisk as well as a UnitAddress can have a streetAddress
ufokn:hasStreetAddress rdf:type owl:ObjectProperty ;
			rdfs:subPropertyOf ufokn:hasAddress ;
			rdfs:domain _:FeatureAtRiskOrUnitAddress ; 
			rdfs:range ufokn:StreetAddress .
# adding a property chain to more easily retrieve the address that is buried inside 
# the UnitAddress of a Collection's individual FeaturesAtRisk 
#			owl:propertyChainAxiom (ufokn:hasMember ufokn:hasUnitAddress ufokn:hasStreetAddress ).

###  http://schema.ufokn.org/ufokn-features/v2/hasMember
ufokn:hasMember rdf:type owl:ObjectProperty ;
			rdf:type owl:InverseFunctionalProperty ;
			rdfs:domain ufokn:CollectionOfFeatures ;
			rdfs:range ufokn:FeatureAtRiskInCollection .


###  http://schema.ufokn.org/ufokn-features/v2/isMemberOf
ufokn:isMemberOf rdf:type owl:ObjectProperty ;
			rdf:type owl:FunctionalProperty ;
			rdfs:domain ufokn:FeatureAtRiskInCollection ;
			rdfs:range ufokn:CollectionOfFeatures ;
			owl:inverseOf ufokn:hasMember .


#################################################################
#    Data properties
#################################################################


###  http://schema.ufokn.org/geo/v2/hasWktGeometry
ufokn-geo:hasWktGeometry rdf:type owl:DatatypeProperty .



### datatype properties for addresses

###  http://schema.ufokn.org/core/v2/unitNumber
ufokn:unitNumber rdf:type owl:DatatypeProperty ;
				rdf:type owl:FunctionalProperty ;
				rdfs:domain ufokn:UnitAddress ;
				rdfs:range xsd:string . 
				
###  http://schema.ufokn.org/core/v2/unitCount
ufokn:unitCount rdf:type owl:DatatypeProperty ;
				rdf:type owl:FunctionalProperty ;
				rdfs:domain ufokn:Address ;
				rdfs:range xsd:positiveInteger . 
				
###  http://schema.ufokn.org/core/v2/areaSize
ufokn:areaSize rdf:type owl:DatatypeProperty ;
				rdf:type owl:FunctionalProperty ;
				rdfs:domain ufokn:Address ;
				rdfs:range xsd:nonNegativeInteger . 
				
###  http://schema.ufokn.org/core/v2/street
ufokn:street rdf:type owl:DatatypeProperty ;
				rdf:type owl:FunctionalProperty ;
				rdfs:domain ufokn:Address ;
				rdfs:range xsd:string . 
				
###  http://schema.ufokn.org/core/v2/streetNumber
ufokn:streetNumber rdf:type owl:DatatypeProperty ;
				rdf:type owl:FunctionalProperty ;
				rdfs:domain ufokn:Address ;
				rdfs:range xsd:string . 

###  http://schema.ufokn.org/core/v2/secondAddressLine
ufokn:secondAddressLine rdf:type owl:DatatypeProperty ;
				rdf:type owl:FunctionalProperty ;
				rdfs:domain ufokn:Address ;
				rdfs:range xsd:string . 

###  http://schema.ufokn.org/core/v2/region
ufokn:region rdf:type owl:DatatypeProperty ;
				rdf:type owl:FunctionalProperty ;
				rdfs:domain ufokn:Address ;
				rdfs:range xsd:string . 

###  http://schema.ufokn.org/core/v2/city
ufokn:city rdf:type owl:DatatypeProperty ;
				rdf:type owl:FunctionalProperty ;
				rdfs:domain ufokn:Address ;
				rdfs:range xsd:string . 

###  http://schema.ufokn.org/core/v2/state
ufokn:state rdf:type owl:DatatypeProperty ;
				rdf:type owl:FunctionalProperty ;
				rdfs:domain ufokn:Address ;
				rdfs:range xsd:string . 
				
###  http://schema.ufokn.org/core/v2/country
ufokn:country rdf:type owl:DatatypeProperty ;
				rdf:type owl:FunctionalProperty ;
				rdfs:domain ufokn:Address ;
				rdfs:range xsd:string . 
				
###  http://schema.ufokn.org/core/v2/district
ufokn:district rdf:type owl:DatatypeProperty ;
				rdf:type owl:FunctionalProperty ;
				rdfs:domain ufokn:Address ;
				rdfs:range xsd:string . 

###  http://schema.ufokn.org/core/v2/postcode
ufokn:postcode rdf:type owl:DatatypeProperty ;
				rdf:type owl:FunctionalProperty ;
				rdfs:domain ufokn:Address ;
				rdfs:range xsd:string . 
				
### Data Properties for Features-at-risk
				
###  http://schema.ufokn.org/core/v2/key
ufokn:key rdf:type owl:DatatypeProperty ;
				rdfs:domain ufokn:FeatureAtRisk ;
				rdfs:range xsd:string . 

###  http://schema.ufokn.org/core/v2/value
ufokn:value rdf:type owl:DatatypeProperty ;
				rdfs:domain ufokn:FeatureAtRisk ;
				rdfs:range xsd:string . 

###  http://schema.ufokn.org/core/v2/osm_id
ufokn:osm_id rdf:type owl:DatatypeProperty ;
				rdfs:domain ufokn:FeatureAtRisk ;
				rdfs:range xsd:string . 

###  http://schema.ufokn.org/core/v2/ms_id
ufokn:ms_id rdf:type owl:DatatypeProperty ;
				rdfs:domain ufokn:FeatureAtRisk ;
				rdfs:range xsd:string . 

###  http://schema.ufokn.org/core/v2/id
ufokn:id rdf:type owl:DatatypeProperty ;
                   rdfs:range xsd:string .

###  http://schema.ufokn.org/core/v2/osm_id
ufokn:osm_id rdf:type owl:DatatypeProperty ;
                   rdfs:subPropertyOf ufokn:id.

###  http://schema.ufokn.org/core/v2/ms_id
ufokn:ms_id rdf:type owl:DatatypeProperty ;
                   rdfs:subPropertyOf ufokn:id.

###  http://schema.ufokn.org/core/v2/oa_id
ufokn:oa_id rdf:type owl:DatatypeProperty ;
                   rdfs:subPropertyOf ufokn:id.
				   
### other datatype properties 
				   
###  http://schema.ufokn.org/core/v2/criticalDepth
ufokn:criticalDepth rdf:type owl:DatatypeProperty ;
                    rdfs:domain ufokn:RiskPoint ;
                    rdfs:range ufokn:depth .


###  http://schema.ufokn.org/core/v2/dataSourceUri
ufokn:dataSourceUri rdf:type owl:DatatypeProperty ;
                    rdfs:range xsd:anyURI .


###  http://schema.ufokn.org/core/v2/heightAboveNearestDrainage
ufokn:heightAboveNearestDrainage rdf:type owl:DatatypeProperty ;
                                 rdfs:domain ufokn:RelativeRiskPointLocation ;
                                 rdfs:range ufokn:elevation .


#################################################################
#    Classes
#################################################################


###  http://schema.ufokn.org/core/v2/DataSource
ufokn:DataSource rdf:type owl:Class ;
                 rdfs:subClassOf owl:Thing ,
                                 [ rdf:type owl:Restriction ;
                                   owl:onProperty ufokn:dataSourceUri ;
                                   owl:someValuesFrom xsd:anyURI
                                 ] ;
                 owl:disjointWith geo:Feature ,
                                  geo:Geometry .


###  http://schema.ufokn.org/core/v2/FeatureAtRisk
ufokn:FeatureAtRisk rdf:type owl:Class ;
                    rdfs:subClassOf geo:Feature,
									ufokn:FeatureOrRegionAtRisk;
                    owl:disjointWith ufokn:RegionOfInterest ,
                                     ufokn:RiskPoint .


###  http://schema.ufokn.org/core/v2/FeatureOrRegionAtRisk
ufokn:FeatureOrRegionAtRisk rdf:type owl:Class ;
                    rdfs:subClassOf geo:Feature .

###  http://schema.ufokn.org/core/v2/CollectionOfFeatures
ufokn:CollectionOfFeatures rdf:type owl:Class ;
				rdfs:subClassOf ufokn:FeatureAtRisk ,
							   [rdf:type owl:Restriction ;
								owl:onProperty ufokn:hasMember ;
                                owl:someValuesFrom ufokn:FeatureAtRisk
							   ] ,
							   [rdf:type owl:Restriction ;
								owl:onProperty ufokn:hasMember ;
                                owl:minQualifiedCardinality "2"^^xsd:nonNegativeInteger ;
								owl:onClass ufokn:FeatureAtRisk
							   ] ;
				owl:disjointWith ufokn:IndividualFeatureAtRisk,
								ufokn:FeatureAtRiskInCollection .


###  http://schema.ufokn.org/core/v2/FeatureAtRiskInCollection
### All FeaturesAtRisk that are a member of some CollectionOfFeatures
ufokn:FeatureAtRiskInCollection rdf:type owl:Class ;
				rdfs:subClassOf ufokn:FeatureAtRisk, 
							   [rdf:type owl:Restriction ;
								owl:onProperty ufokn:isMemberOf ;
                                owl:someValuesFrom ufokn:CollectionOfFeatures
							   ] ,
							   [rdf:type owl:Restriction ;
								owl:onProperty ufokn:hasAddress ;
								owl:allValuesFrom ufokn:UnitAddress
							   ] ;
				owl:disjointWith ufokn:IndividualFeatureAtRisk, 
								ufokn:CollectionOfFeatures .
							   
		   
### New: IndividualFeatureAtRisk, which relaxes the previous condition to those that have noMembers
### but is agnotistic about whether it is part of a collection
###  http://schema.ufokn.org/core/v2/IndividualFeatureAtRisk
### All FeaturesAtRisk that are a member of some CollectionOfFeatures
ufokn:IndividualFeatureAtRisk rdf:type owl:Class ;
				rdfs:subClassOf ufokn:FeatureAtRisk ,
								[rdf:type owl:Restriction ;
								 owl:onProperty ufokn:hasMember ;
								 owl:maxCardinality "0"^^xsd:nonNegativeInteger
								] .				


### Renamed: StandaloneFeatureAtRisk							   
###  http://schema.ufokn.org/core/v2/StandaloneFeatureAtRisk
### All StandaloneFeaturesAtRisk are IndividualFeaturesAtRisk that are also not a member of some CollectionOfFeatures
ufokn:StandaloneFeatureAtRisk rdf:type owl:Class ;
				rdfs:subClassOf ufokn:IndividualFeatureAtRisk ,
								[rdf:type owl:Restriction ;
								 owl:onProperty ufokn:isMemberOf ;
								 owl:maxCardinality "0"^^xsd:nonNegativeInteger
								] ;
				owl:equivalentClass _:DefStandaloneFeatureAtRisk .

			
_:DefStandaloneFeatureAtRisk rdf:type owl:Class ;
				owl:intersectionOf (ufokn:FeatureAtRisk _:FeatureAtRiskNotMemberOfACollection _:FeatureAtRiskWithoutMembers).

### FeatureAtRiskNotMemberOfACollection are not member of any CollectionOfFeatures. 
_:FeatureAtRiskNotMemberOfACollection rdf:type owl:Restriction ;
									owl:onProperty ufokn:isMemberOf ;
									owl:maxCardinality "0"^^xsd:nonNegativeInteger . 

### FeatureAtRiskWithoutMembers are not member of any CollectionOfFeatures. 
_:FeatureAtRiskWithoutMembers rdf:type owl:Restriction ;
									owl:onProperty ufokn:hasMember ;
									owl:maxCardinality "0"^^xsd:nonNegativeInteger . 

_:FeatureAtRiskOrUnitAddress  rdf:type owl:Class ;
				owl:unionOf (ufokn:FeatureAtRisk ufokn:UnitAddress) .


###  http://schema.ufokn.org/core/v2/Address
ufokn:Address rdf:type owl:Class .

###  http://schema.ufokn.org/core/v2/StreetAddress
ufokn:StreetAddress rdf:type owl:Class ;
		rdfs:subClassOf ufokn:Address ,
						[rdf:type owl:Restriction ;
						 owl:onProperty ufokn:street ;
                         owl:cardinality "1"^^xsd:nonNegativeInteger
						] ,
						[rdf:type owl:Restriction ;
						 owl:onProperty ufokn:postcode ;
                         owl:cardinality "1"^^xsd:nonNegativeInteger
						] ,
						[rdf:type owl:Restriction ;
						 owl:onProperty ufokn:unitCount ;
                         owl:cardinality "1"^^xsd:nonNegativeInteger
						].


###  http://schema.ufokn.org/core/v2/UnitAddress
ufokn:UnitAddress rdf:type owl:Class ;
				rdfs:subClassOf ufokn:Address ,
							[rdf:type owl:Restriction ;
							 owl:onProperty ufokn:unitNumber ;
                             owl:cardinality "1"^^xsd:nonNegativeInteger
							] ,
							[rdf:type owl:Restriction ;
							 owl:onProperty ufokn:unitCount ;
							 owl:hasValue "1"^^xsd:nonNegativeInteger
							] ;
				owl:equivalentClass _:DefAddressesWithUnit .

_:DefAddressesWithUnit owl:intersectionOf (ufokn:Address _:HasUnitNumber) .

_:HasUnitNumber rdf:type owl:Restriction ;
						owl:onProperty ufokn:unitNumber ;
						owl:minCardinality "1"^^xsd:nonNegativeInteger . 




###  http://schema.ufokn.org/core/v2/RegionOfInterest
ufokn:RegionOfInterest rdf:type owl:Class ;
                       rdfs:subClassOf geo:Feature ,
                                       [ rdf:type owl:Restriction ;
                                         owl:onProperty geo:hasGeometry ;
                                         owl:allValuesFrom geo:Polygon
                                       ] ,
                                       [ rdf:type owl:Restriction ;
                                         owl:onProperty geo:hasGeometry ;
                                         owl:qualifiedCardinality "1"^^xsd:nonNegativeInteger ;
                                         owl:onClass geo:Polygon
                                       ] ;
                       owl:disjointWith ufokn:RiskPoint,
										ufokn:FeatureAtRisk	.
						
###  http://schema.ufokn.org/core/v2/RelativeRiskPointLocation
ufokn:RelativeRiskPointLocation rdf:type owl:Class ;
                                rdfs:subClassOf [ rdf:type owl:Restriction ;
                                                  owl:onProperty ufokn:locationForRiskPoint ;
                                                  owl:minQualifiedCardinality "1"^^xsd:nonNegativeInteger ;
                                                  owl:onClass ufokn:RiskPoint
                                                ] .


###  http://schema.ufokn.org/core/v2/RiskPoint
ufokn:RiskPoint rdf:type owl:Class ;
                rdfs:subClassOf geo:Feature ,
								sosa:FeatureOfInterest ,
                                [ rdf:type owl:Restriction ;
                                  owl:onProperty geo:hasGeometry ;
                                  owl:allValuesFrom geo:Point
                                ] ,
                                [ rdf:type owl:Restriction ;
                                  owl:onProperty geo:hasGeometry ;
                                  owl:qualifiedCardinality "1"^^xsd:nonNegativeInteger ;
                                  owl:onClass geo:Point
                                ] .


###  http://www.opengis.net/spec/geosparql/1.0#Feature
geo:Feature rdf:type owl:Class .


###  http://www.opengis.net/spec/geosparql/1.0#Geometry
geo:Geometry rdf:type owl:Class .


###  http://www.opengis.net/spec/geosparql/1.0#Point
geo:Point rdf:type owl:Class ;
          rdfs:subClassOf geo:Geometry .


#################################################################
#    General axioms
#################################################################

[ rdf:type owl:AllDisjointClasses ;
  owl:members ( ufokn:DataSource
                ufokn:RelativeRiskPointLocation
                geo:Feature
                geo:Geometry
				ufokn-geo:SpatialReferenceSystem
				ufokn:Address
              )
] .


[ rdf:type owl:AllDisjointClasses ;
  owl:members ( ufokn:FeatureAtRisk
                ufokn:RegionOfInterest
                ufokn:RiskPoint
              )
] .


#################################################################
#    Individuals
#################################################################

ufokn:MSdataSource rdf:type ufokn:DataSource. 
ufokn:OAdataSource rdf:type ufokn:DataSource. 
ufokn:OSMdataSource rdf:type ufokn:DataSource. 
